# ■ 「実行速度の最適化のあれこれプラスおまけ」の要約

# ■ スライドへのリンク
* [{SlideShare} 実行速度の最適化のあれこれプラスおまけ](https://www.slideshare.net/EpicGamesJapan/ss-137253035)

# ■ 要約
* 概要
	* 揺れものアニメーションをプラグインやモジュールにて拡張した際の事例
	* PGO による最適化に関する情報
* 読むべき人
	* 主たるターゲット
		* プログラマー（リード、揺れもの担当、最適化担当、自動化・ビルド担当）
	* 補助的なターゲット
		* ディレクター（工数把握）

# ■ 講演者
* プログラマーの HUI T.Y. Fred 氏の講演
	* 揺れものアニメーションのライブラリの窓口、カスタマイズ、速度最適化
	* 最適化チームのメンバー

# ■ スライド内容のメモ
* ※ここから先はほぼスライドの内容全部を書き写しただけのスライド全体の俯瞰用のテキストです。
* 揺れものアニメーションの最適化
	* ライブラリ
		* Bonamik - B Plugin
			* 鎖、紐、髪、クロスなどの物理シミュレーション
		* KineDriver - K Plugin
			* 補助骨、ドライバー
	* 社内での利用実績あり。
	* UE4 では初対応。 Plugin として実装。
		* テクノロジー推進部のメンバーたちとの共同開発。
	* UE4 を改造する設計
		* **このあたり、説明文が極端に少なく意図が読めないが、以下の３段階を経ている**
		* **どのステップで出のような変更を行った課はスライド参照**
		1. 上記２つのライブラリをコンポーネントとして実装
		1. 上記２つのコンポーネントの処理をまとめて行う統合版コンポーネント（ KBD Component ）の作成
			* 変更したのは、コンポーネントを分けてしまうと処理の都合が悪い為
			* 表現幅の向上
			* K と B の処理純が可変となった
			* Plugin を Module にリファクタリングする必要があった。
		1. マネージャクラスの導入
			* 並列化のスケジューラ
			* 並列化の際の Actor 毎の負荷の差をどのようにスケジュールするか。
* PGO による**実行速度**最適化
	* PGO - Profile Guided Optimization
	* コンパイラとリンカー要対応
	* プロファイルの結果に基づく最適化
	* **解説があるので、詳細はスライド参照**
	* 実際に実行させた際に呼ばれる回数が多かったり重かったりする部分を速度最適化し、それ以外をサイズ最適化する。
	* PDC サイクルが必要となるので、計画性が重要
	* Shipping で、最大 37ms -> 33ms の改善があった。
	* UE4 4.19 以降では Sampling PGO という機能が利用できた。
		* TrainingBuild が不要
	* 開発サイクル中は S-PGO を利用し、最終リリース時期では PGO を利用するのが好ましい。

----
以上。
